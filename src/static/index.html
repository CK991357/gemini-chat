<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Chat Multimodal Live API Client</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <!-- å»ºè®®ä½¿ç”¨å¡«å……ç‰ˆæœ¬å›¾æ ‡ -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />
    <!-- æ–°å¢ï¼šç”¨äºè¯­éŸ³æ’­æ”¾å™¨å›¾æ ‡ -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="css/style.css">
    <!-- å¼•å…¥ MathJax ç”¨äºæ•°å­¦å…¬å¼æ¸²æŸ“ -->
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <!-- å¼•å…¥ marked.js ç”¨äº Markdown æ¸²æŸ“ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- å¼•å…¥ highlight.js ç”¨äºä»£ç é«˜äº® -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark-dimmed.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <!-- æ–°å¢ï¼šå¼•å…¥ pdf.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
    <script>
        // è®¾ç½® pdf.js worker çš„è·¯å¾„
        pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js`;
    </script>
</head>
<body>
    <div id="toast-container"></div>
    <div class="app-container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <nav class="app-nav">
            <div class="mode-switcher">
                <h1 class="app-title">Gemini Chat</h1>
                <button id="chat-mode-button" data-mode="chat" class="mode-button active">ğŸ“ æ–‡å­—èŠå¤©</button>
                <button id="translation-mode-button" data-mode="translate" class="mode-button">ğŸŒ å¤šè¯­è¨€ç¿»è¯‘</button>
                <button id="vision-mode-button" data-mode="camera_enhance" class="mode-button">ğŸ–¼ï¸ è§†è§‰åˆ†æ</button>
            </div>
            <div class="nav-tools">
                <button id="new-chat-button" class="material-symbols-outlined">add_box</button>
                <button id="toggle-config" class="material-symbols-outlined">settings</button>
                <button id="toggle-log" class="material-symbols-outlined">description</button>
                <button id="theme-toggle" class="material-symbols-outlined">light_mode</button>

            <!-- ç§»åŠ¨åª’ä½“æ§åˆ¶æŒ‰é’®åˆ°è¿™é‡Œ -->
            <div class="media-controls">
                <button id="mic-button" class="media-button material-symbols-outlined">mic</button>
                <button id="camera-button" class="media-button material-symbols-outlined">videocam</button>
                <button id="screen-button" class="media-button material-symbols-outlined">screen_share</button>
                <!-- ç§»é™¤ç¿»è½¬æŒ‰é’® -->
                 </div>
            </div>
        </nav>

        <!-- ä¸»å®¹å™¨ï¼šå·¦å³åˆ†æ  -->
        <div class="main-container">
            <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
            <aside class="control-panel">
                <div class="settings-card">
                    <h3>è®¾ç½®</h3>
                    <div class="setting-item">
                        <label for="api-key">API Key:</label>
                        <input type="password" id="api-key" placeholder="Please Input Gemini API Key" />
                    </div>
                    <div class="setting-item">
                        <label for="voice-select">å£°éŸ³:</label>
                        <select id="voice-select">
                            <option value="Puck">Puck (Male)</option>
                            <option value="Charon">Charon (Male)</option>
                            <option value="Fenrir">Fenrir (Male)</option>
                            <option value="Kore">Kore (Female)</option>
                            <option value="Aoede" selected>Aoede (Female)</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="response-type-select">å“åº”ç±»å‹:</label>
                        <select id="response-type-select">
                            <option value="text">Text</option>
                            <option value="audio" selected>Audio</option>
                        </select>
                    </div>
                    <!-- æ–°å¢æ¨¡å‹é€‰æ‹©ä¸‹æ‹‰èœå• -->
                    <div class="setting-item">
                        <label for="model-select">æ¨¡å‹é€‰æ‹©:</label>
                        <select id="model-select">
                            <option value="models/gemini-2.0-flash-exp">gemini-2.0-flash-exp</option>
                            <option value="models/gemini-2.5-flash-preview-05-20" selected>gemini-2.5-flash-preview-05-20</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="fps-input">è§†é¢‘ FPS:</label>
                        <input type="number" id="fps-input" placeholder="Video FPS" value="1" min="1" max="30" step="1"/>
                        <span class="fps-help">æ›´é«˜ FPS éœ€è¦æ›´å¤šç½‘ç»œå¸¦å®½</span>
                    </div>
                    <div class="setting-item">
                        <label for="prompt-select">æŒ‡ä»¤æ¨¡å¼:</label>
                        <select id="prompt-select"></select>
                    </div>
                    <div class="setting-item full-width" style="display: none;">
                        <label for="system-instruction">ç³»ç»ŸæŒ‡ä»¤ (éšè—):</label>
                        <textarea id="system-instruction" placeholder="Enter custom system instructions..." rows="6"></textarea>
                    </div>
                    <div class="button-group">
                        <button id="apply-config" class="action-button">ç¡®è®¤</button>
                        <button id="connect-button" class="action-button primary">è¿æ¥</button>
                    </div>
                    </div>
            </aside>

            <!-- å³ä¾§ä¸»å†…å®¹åŒº -->
            <div class="content-area">
                <!-- æ¨¡å¼åˆ‡æ¢é€‰é¡¹å¡ -->
                <!-- ä¸»å†…å®¹åŒºé¡¶éƒ¨çš„æ¨¡å¼åˆ‡æ¢é€‰é¡¹å¡ -->
                <!-- èŠå¤©åŠŸèƒ½åŒº -->
                <section class="chat-container active" id="chat-section">
                    <!-- èŠå¤©æ¨¡å¼å†…éƒ¨çš„å­æ ‡ç­¾é¡µ -->
                    <div class="mode-tabs" id="chat-mode-tabs">
                        <button class="tab active" data-mode="chat-text">ğŸ“ æ–‡å­—èŠå¤©</button>
                        <button class="tab" data-mode="chat-log">ğŸ“‹ ç³»ç»Ÿæ—¥å¿—</button>
                        <button class="tab" data-mode="chat-history">ğŸ“œ å†å²è®°å½•</button>
                    </div>
                    <div class="tab-content active" data-tab-id="chat-text">
                        <div class="media-previews" id="media-previews">
                            <div id="video-container" class="media-preview">
                                <video id="preview" playsinline webkit-playsinline autoplay muted></video>
                                <div class="video-controls">
                                    <button id="flip-camera" class="media-button material-symbols-outlined">flip_camera_ios</button>
                                    <button id="stop-video" class="close-button material-symbols-outlined">close</button>
                                </div>
                            </div>
                            <div id="screen-preview-container" class="media-preview">
                                <video id="screen-preview-element" playsinline webkit-playsinline autoplay muted></video>
                                <button id="stop-screen-button" class="close-button material-symbols-outlined">close</button>
                            </div>
                        </div>
                        
                        <div class="message-history" id="message-history">
                            <!-- èŠå¤©æ¶ˆæ¯åŠ¨æ€æ’å…¥ -->
                        </div>

                        <!-- æ–‡ä»¶é™„ä»¶é¢„è§ˆå®¹å™¨ -->
                        <div class="file-attachment-previews" id="file-attachment-previews">
                            <!-- é™„ä»¶é¢„è§ˆå°†åŠ¨æ€æ’å…¥æ­¤å¤„ -->
                        </div>
                        
                        <!-- è¾“å…¥åŒºåŸŸ -->
                        <div class="input-area">
                            <textarea id="message-input" placeholder="è¾“å…¥æ¶ˆæ¯..." rows="1"></textarea>
                            <button id="send-button" class="send-button material-symbols-outlined">send</button>
                            <button id="interrupt-button" class="action-button">||</button>
                            <button id="attachment-button" class="action-button material-symbols-outlined">attach_file</button>
                            <button id="chat-voice-input-button" class="action-button material-symbols-outlined">mic</button>
                            <input type="file" id="file-input" accept="image/jpeg,image/png,image/webp,application/pdf" style="display: none;">
                        </div>
                    </div>

                    <!-- èŠå¤©æ¨¡å¼ä¸‹çš„ç³»ç»Ÿæ—¥å¿—åŒº -->
                    <div class="tab-content" data-tab-id="chat-log">
                        <div class="log-header">
                            <h3>ç³»ç»Ÿæ—¥å¿—</h3>
                            <button id="clear-logs" class="action-button">æ¸…ç©º</button>
                        </div>
                        <div class="log-content" id="logs-container">
                            <!-- åŸå§‹æ—¥å¿—å†…å®¹å°†åŠ¨æ€æ’å…¥æ­¤å¤„ -->
                        </div>
                    </div>

                    <!-- èŠå¤©æ¨¡å¼ä¸‹çš„å†å²è®°å½•åŒº -->
                    <div class="tab-content" data-tab-id="chat-history">
                        <div class="log-header">
                            <h3>å†å²è®°å½•</h3>
                        </div>
                        <div class="history-list" id="history-list-container">
                            <!-- å†å²è®°å½•åˆ—è¡¨å°†åŠ¨æ€æ’å…¥æ­¤å¤„ -->
                        </div>
                    </div>
                </section>

                <!-- ç¿»è¯‘åŠŸèƒ½åŒº -->
                <section class="translation-container" id="translation-section">
                    <div class="mode-tabs" id="translation-mode-tabs">
                        <button class="tab active" data-mode="translation-text">ğŸ“ å¤šè¯­è¨€ç¿»è¯‘</button>
                        <button class="tab" data-mode="translation-log">ğŸ“‹ ç³»ç»Ÿæ—¥å¿—</button>
                        <button class="tab" data-mode="translation-history">ğŸ“œ å†å²è®°å½•</button>
                    </div>
                    <div class="tab-content active" data-tab-id="translation-text">
                        <div class="translation-input-area">
                            <div class="translation-controls">
                                <select id="translation-input-language-select" title="é€‰æ‹©è¾“å…¥è¯­è¨€"></select>
                                <select id="translation-model-select" title="é€‰æ‹©ç¿»è¯‘æ¨¡å‹">
                                    <option value="gemini-2.5-flash-lite-preview-06-17" selected>gemini-2.5-flash-lite-preview-06-17</option>
                                    <option value="THUDM/GLM-4-9B-0414">THUDM/GLM-4-9B-0414</option>
                                </select>
                            </div>
                            <textarea id="translation-input-text" placeholder="è¾“å…¥è¦ç¿»è¯‘çš„å†…å®¹..." rows="10"></textarea>
                            <div class="translation-action-buttons">
                                <button id="translation-ocr-button" class="action-button material-symbols-outlined" style="display: none;">add_a_photo</button>
                                <input type="file" id="translation-ocr-input" accept="image/*" capture="environment" style="display: none;">
                                <button id="translate-button" class="action-button">ç¿»è¯‘</button>
                                <button id="translation-voice-input-button" class="action-button">è¯­éŸ³è¾“å…¥</button>
                            </div>
                        </div>
                        <div class="translation-output-area">
                            <div class="translation-controls">
                                <select id="translation-output-language-select" title="é€‰æ‹©è¾“å‡ºè¯­è¨€"></select>
                            </div>
                            <div id="translation-output-text" class="translation-output-display"></div>
                            <button id="translation-copy-button" class="copy-button material-symbols-outlined">content_copy</button>
                        </div>
                    </div>
                    <div class="tab-content" data-tab-id="translation-log">
                        <div class="log-header">
                            <h3>ç³»ç»Ÿæ—¥å¿—</h3>
                            <button id="clear-logs" class="action-button">æ¸…ç©º</button>
                        </div>
                        <div class="log-content" id="logs-container">
                            <!-- åŸå§‹æ—¥å¿—å†…å®¹å°†åŠ¨æ€æ’å…¥æ­¤å¤„ -->
                        </div>
                    </div>
                    <div class="tab-content" data-tab-id="translation-history">
                        <div class="log-header">
                            <h3>å†å²è®°å½•</h3>
                        </div>
                        <div class="history-list">
                            <p style="text-align: center; padding: 20px;">å½“å‰æ¨¡å¼æš‚ä¸æ”¯æŒ</p>
                        </div>
                    </div>
                </section>

                <!-- è§†è§‰æ¨¡å‹åŠŸèƒ½åŒº -->
                <section class="vision-container" id="vision-section">
                    <div class="mode-tabs" id="vision-mode-tabs">
                        <button class="tab active" data-mode="vision-chat">ğŸ–¼ï¸ è§†è§‰åˆ†æ</button>
                        <button class="tab" data-mode="vision-log">ğŸ“‹ ç³»ç»Ÿæ—¥å¿—</button>
                        <button class="tab" data-mode="vision-history">ğŸ“œ å†å²è®°å½•</button>
                    </div>
                    <div class="tab-content active" data-tab-id="vision-chat">
                        <div class="message-history" id="vision-message-history">
                            <!-- Vision chat messages will be dynamically inserted here -->
                        </div>

                        <div class="file-attachment-previews" id="vision-attachment-previews">
                            <!-- Attachment previews for vision mode will be dynamically inserted here -->
                        </div>

                        <div class="vision-controls">
                            <label for="vision-model-select">æ¨¡å‹:</label>
                            <select id="vision-model-select"></select>
                        </div>
                        <div class="input-area" id="vision-input-area">
                            <textarea id="vision-input-text" placeholder="è¾“å…¥æè¿°æˆ–é—®é¢˜..." rows="1"></textarea>
                            <button id="vision-attachment-button" class="action-button material-symbols-outlined">attach_file</button>
                            <input type="file" id="vision-file-input" accept="image/*,video/*,application/pdf" style="display: none;" multiple>
                            <button id="vision-send-button" class="send-button material-symbols-outlined">send</button>
                        </div>
                    </div>
                    <div class="tab-content" data-tab-id="vision-log">
                        <div class="log-header">
                            <h3>ç³»ç»Ÿæ—¥å¿—</h3>
                            <button id="clear-logs" class="action-button">æ¸…ç©º</button>
                        </div>
                        <div class="log-content" id="logs-container">
                            <!-- åŸå§‹æ—¥å¿—å†…å®¹å°†åŠ¨æ€æ’å…¥æ­¤å¤„ -->
                        </div>
                    </div>
                    <div class="tab-content" data-tab-id="vision-history">
                        <div class="log-header">
                            <h3>å†å²è®°å½•</h3>
                        </div>
                        <div class="history-list">
                            <p style="text-align: center; padding: 20px;">å½“å‰æ¨¡å¼æš‚ä¸æ”¯æŒ</p>
                        </div>
                    </div>
                </section>

            </div>
        </div>

    </div>
    <script src="js/main.js" type="module"></script>
</body>
</html>
